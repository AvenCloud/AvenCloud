# Migration `20201213000707-site-token`

This migration has been generated by Eric Vicenti at 12/12/2020, 4:07:08 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "SiteToken" (
"id" SERIAL,
    "createTime" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "siteId" INTEGER NOT NULL,
    "label" TEXT NOT NULL,
    "type" TEXT NOT NULL,
    "token" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "SiteToken.token_unique" ON "SiteToken"("token")

ALTER TABLE "SiteToken" ADD FOREIGN KEY("siteId")REFERENCES "Site"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201125071140-site-invites..20201213000707-site-token
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -73,8 +73,9 @@
   SiteNode           SiteNode[]
   SiteRole           SiteRole[]
   SiteRoleInvitation SiteRoleInvitation[]
+  SiteToken          SiteToken[]
 }
 model SiteNode {
   id           Int       @id @default(autoincrement())
@@ -92,8 +93,18 @@
   @@unique([siteId, key, parentNodeId], name: "SiteNodeId")
 }
+model SiteToken {
+  id         Int      @id @default(autoincrement())
+  createTime DateTime @default(now())
+  siteId     Int
+  site       Site     @relation(fields: [siteId], references: [id])
+  label      String
+  type       String
+  token      String   @unique
+}
+
 model NodeRole {
   id         Int      @id @default(autoincrement())
   siteNodeId Int
   siteNode   SiteNode @relation(fields: [siteNodeId], references: [id])
```


